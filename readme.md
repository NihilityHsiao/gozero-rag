# Go-Zero RAG çŸ¥è¯†åº“ç³»ç»Ÿ

åŸºäº Go-Zero å’Œ React æ„å»ºçš„ä¼ä¸šçº§é«˜æ€§èƒ½ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰çŸ¥è¯†åº“ç³»ç»Ÿã€‚

## ğŸ“– é¡¹ç›®ä»‹ç»

æœ¬é¡¹ç›®æ—¨åœ¨å¸®åŠ©ä¼ä¸šä¸ä¸ªäººå¿«é€Ÿæ­å»ºç§æœ‰åŒ–çŸ¥è¯†åº“ï¼Œé€šè¿‡å‘é‡æ£€ç´¢ä¸ LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰çš„æ·±åº¦ç»“åˆ (RAG)ï¼Œæœ‰æ•ˆè§£å†³å¤§æ¨¡å‹åœ¨å‚ç›´é¢†åŸŸçŸ¥è¯†ç¼ºå¤±ã€å³æ—¶æ€§ä¸è¶³ä¸å¹»è§‰é—®é¢˜ã€‚
æœ€æ–°ç‰ˆæœ¬æ”¯æŒ **GraphRAG (çŸ¥è¯†å›¾è°±å¢å¼ºæ£€ç´¢)**ï¼Œé€šè¿‡æå–å®ä½“ä¸å…³ç³»ï¼Œæ„å»ºæ›´æ·±å±‚æ¬¡çš„è¯­ä¹‰ç†è§£èƒ½åŠ›ã€‚

æ ¸å¿ƒå®šä½ä¸ºï¼š**é«˜æ€§èƒ½ã€æ˜“æ‰©å±•ã€å¼€ç®±å³ç”¨çš„ RAG è§£å†³æ–¹æ¡ˆ**ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **å¤šæ ¼å¼è§£æ**: æ”¯æŒ PDF, TXT, Word, Markdown ç­‰ä¸»æµæ–‡æ¡£æ ¼å¼çš„ä¸Šä¼ ä¸è§£æã€åˆ‡ç‰‡ã€‚
- **çŸ¥è¯†å›¾è°± (GraphRAG)**: 
    - **è‡ªåŠ¨æå–**: åŸºäº LLM çš„ Loop-Gleaning ç­–ç•¥ï¼Œè‡ªåŠ¨æå–æ–‡æ¡£ä¸­çš„å®ä½“ï¼ˆç»„ç»‡ã€äººç‰©ã€åœ°ç†ã€äº‹ä»¶ã€ç±»åˆ«ï¼‰åŠå…¶å…³ç³»ã€‚
    - **ç»Ÿä¸€å­˜å‚¨**: æ‰€æœ‰æ•°æ®ï¼ˆæ–‡æ¡£åˆ†ç‰‡å‘é‡ã€çŸ¥è¯†å›¾è°±å®ä½“ä¸å…³ç³»ï¼‰ç»Ÿä¸€å­˜å‚¨äº **Elasticsearch**ï¼Œç®€åŒ–æ¶æ„å¹¶æå‡è¿ç»´æ•ˆç‡ã€‚
    - **å¯è§†/é…ç½®**: åœ¨å‰ç«¯å¯é…ç½®æ˜¯å¦å¯ç”¨å›¾è°±åŠŸèƒ½åŠå®ä½“ç±»å‹ã€‚
- **çµæ´»ç¼–æ’**: åŸºäºå­—èŠ‚è·³åŠ¨ **Eino** æ¡†æ¶ï¼Œæ”¯æŒå¤æ‚çš„ RAG æ£€ç´¢æµç¨‹ä¸å›¾æå–å·¥ä½œæµç¼–æ’ã€‚
- **é«˜æ€§èƒ½æ£€ç´¢**: åŸºäº Elasticsearch çš„å‘é‡æ£€ç´¢èƒ½åŠ› (KNN)ï¼Œæ”¯æŒæµ·é‡æ•°æ®æ¯«ç§’çº§æ£€ç´¢ã€‚
- **æ··åˆæ£€ç´¢**: å……åˆ†åˆ©ç”¨ ES çš„èƒ½åŠ›ï¼Œæ”¯æŒå…³é”®è¯æ£€ç´¢ (BM25) ä¸å‘é‡æ£€ç´¢çš„æ··åˆå¬å› (Hybrid Search) åŠé‡æ’åº (Rerank)ã€‚
- **ç°ä»£åŒ–äº¤äº’**: é‡‡ç”¨ React + Shadcn/ui æ‰“é€ æç®€ã€æµç•…çš„ç±» Dify ç”¨æˆ·ä½“éªŒã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

### åç«¯ (Backend)
- **æ ¸å¿ƒæ¡†æ¶**: [Go-Zero](https://go-zero.dev/) (Web/RPC, Middleware)
- **å¤§æ¨¡å‹ç¼–æ’**: ByteDance Eino (Graph/Chain, Node, Edge)
- **æ•°æ®åº“**: 
    - MySQL 8.0+ (ä¸šåŠ¡å…ƒæ•°æ®)
    - Redis (ç¼“å­˜ä¸ä¼šè¯)
    - [Elasticsearch](https://www.elastic.co/) (æ ¸å¿ƒæ£€ç´¢å¼•æ“ï¼šè´Ÿè´£å‘é‡å­˜å‚¨ã€å€’æ’ç´¢å¼•åŠçŸ¥è¯†å›¾è°±å­˜å‚¨)
- **å¯¹è±¡å­˜å‚¨**: MinIO
- **æ¶ˆæ¯é˜Ÿåˆ—**: Kafka (å¼‚æ­¥ä»»åŠ¡è§£è€¦ï¼šæ–‡æ¡£è§£æã€å›¾è°±ç”Ÿæˆ)

### å‰ç«¯ (Frontend)
- **æ¡†æ¶**: React 18 (Vite)
- **UI ç»„ä»¶åº“**: Shadcn/ui + Tailwind CSS
- **çŠ¶æ€ç®¡ç†**: Zustand
- **è¯­è¨€**: TypeScript

## ğŸ“‚ é¡¹ç›®ç»“æ„

```text
â”œâ”€â”€ restful/          # HTTP API æœåŠ¡ (Go-Zero Gateway)
â”‚   â””â”€â”€ rag/          # ä¸»ä¸šåŠ¡æœåŠ¡
â”œâ”€â”€ consumer/         # å¼‚æ­¥æ¶ˆæ¯æ¶ˆè´¹è€… (Workers)
â”‚   â”œâ”€â”€ document_index/ # æ–‡æ¡£åˆ‡ç‰‡ä¸å‘é‡åŒ–æ¶ˆè´¹è€…
â”‚   â””â”€â”€ graph_extract/  # çŸ¥è¯†å›¾è°±æå–æ¶ˆè´¹è€…
â”œâ”€â”€ internal/         # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä¸å…±äº«ä»£ç 
â”‚   â”œâ”€â”€ model/        # æ•°æ®åº“æ¨¡å‹ (MySQL, ES)
â”‚   â”œâ”€â”€ mq/           # æ¶ˆæ¯é˜Ÿåˆ—å®šä¹‰
â”‚   â””â”€â”€ graphrag/     # GraphRAG æ ¸å¿ƒç®—æ³•å®ç°
â”œâ”€â”€ script/           # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ (MySQL, ES, Docker)
â””â”€â”€ fe/               # å‰ç«¯é¡¹ç›® (React)
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚
- **Go**: 1.21+
- **Node.js**: 18+
- **Docker & Docker Compose**
- **Goctl**: `go install github.com/zeromicro/go-zero/tools/goctl@latest`

### 2. åŸºç¡€è®¾æ–½æ­å»º
ä½¿ç”¨ Docker Compose å¯åŠ¨æ‰€æœ‰ä¾èµ–æœåŠ¡ï¼ˆMySQL, Redis, MinIO, Kafka, Elasticsearchï¼‰ï¼š

```bash
docker-compose up -d
```

è¯·ç¡®ä¿æ‰€æœ‰å®¹å™¨çŠ¶æ€å¥åº· (Healthy) åå†ç»§ç»­ã€‚

### 3. åç«¯å¯åŠ¨ (å¤šæœåŠ¡)

æœ¬é¡¹ç›®é‡‡ç”¨å¾®æœåŠ¡/åˆ†å¸ƒå¼æ¶æ„ï¼Œéœ€åˆ†åˆ«å¯åŠ¨ API æœåŠ¡å’Œå„ç±»æ¶ˆè´¹è€…ã€‚

#### 3.1 å¯åŠ¨ API æœåŠ¡
```bash
# 1. å®‰è£…ä¾èµ–
go mod tidy

# 2. è¿è¡Œ RESTful API
cd restful/rag
go run rag.go
# æœåŠ¡é»˜è®¤è¿è¡Œåœ¨ 8888 ç«¯å£
```

#### 3.2 å¯åŠ¨æ¶ˆè´¹è€… (Workers)
å»ºè®®æ–°å¼€ç»ˆç«¯çª—å£å¯åŠ¨å¼‚æ­¥ä»»åŠ¡æ¶ˆè´¹è€…ï¼š

```bash
# 1. å¯åŠ¨æ–‡æ¡£ç´¢å¼•æ¶ˆè´¹è€… (å¤„ç†æ–‡æ¡£è§£æã€å‘é‡åŒ–)
cd consumer/document_index
go run main.go

# 2. å¯åŠ¨å›¾è°±æå–æ¶ˆè´¹è€… (å¯é€‰, éœ€å¼€å¯ GraphRAG åŠŸèƒ½)
cd consumer/graph_extract
go run main.go
```

### 4. å‰ç«¯å¯åŠ¨

1. **å®‰è£…ä¾èµ–**:
    ```bash
    cd fe
    npm install
    ```

2. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**:
    ```bash
    npm run dev
    ```
    å‰ç«¯é¡µé¢é€šå¸¸è®¿é—®åœ°å€ä¸º `http://localhost:5173`ã€‚

## ğŸ’» ä»£ç ç”ŸæˆæŒ‡å—

> [!IMPORTANT]
> **è¯·å‹¿ç›´æ¥ä½¿ç”¨ `goctl` ç”Ÿæˆ API/Model ä»£ç ã€‚** è¯·åŠ¡å¿…ä½¿ç”¨é¢„å®šä¹‰çš„ Make å‘½ä»¤ä»¥ç¡®ä¿ä¸€è‡´æ€§ã€‚

- **ç”Ÿæˆ API ä»£ç **: `make gen-api` (ä¿®æ”¹ `restful/rag/rag.api` å)
- **ç”Ÿæˆ MySQL Model**: `make gen-model` (ä¿®æ”¹ `script/mysql/*.sql` å)
- **ç”Ÿæˆ API æ–‡æ¡£**: `make gen-doc`

## ğŸ“¸ è¿è¡Œæˆªå›¾
![çŸ¥è¯†å›¾è°±](images/image-kg.png)
![çŸ¥è¯†å›¾è°±2](images/image-kg2.png)
![alt text](images/image.png)
![alt text](images/image-1.png)
![alt text](images/image-2.png)
![alt text](images/image-3.png)
![alt text](images/image-4.png)